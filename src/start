#!/bin/sh 
# Script auto-called via systemd on boot
# Or you could run: $ ./biophonic1 to start the app...

# Make sure this script is runs as root so network/mount things work
LUID=$(id -u)
if [ $LUID -ne 0 ]; then
    echo "$0 must be run as root"
    exit 1
fi

# Cleanup any open processes
./stop > /dev/null                  

# Mount the sd card Note: Now manged by fstab...
#SD=$(ls ~/sdcard/sound | grep "No such file or directory")
#if [ -z "$SD" ]; then
#mount -L biophonic1 -t vfat /home/sonic/sdcard -o umask=000 > /dev/null
#fi

# Make sure we can write to the SD card
chmod 777 /home/sonic/sdcard -R

# Start the map reading and gps application
cd /home/sonic/bicrophonic1/src       # Move to our dir so relative paths work
sleep 5                               # Lets give the audio card time to startup
amixer -c 0 set PCM 100% > /dev/null  # Set initital audio volume
#./bicrophonic1 & > /dev/null         # Start the app

# Start the Audio Engine
/home/sonic/SonicBikeAudioEngine/bin/SonicBikeAudioEngine & > /dev/null

# Release the worms! (scan for wifi and read analog input)
./worms #& > /dev/null
